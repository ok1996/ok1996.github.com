(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{746:function(a,s,e){"use strict";e.r(s);var t=e(7),n=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),s("p",[a._v("依赖使用HikariCP、P6spy监控日志、MybatisPlus、包含通用CURD控制层"),s("br"),a._v("\n功能：启动应用程序自动创建数据库、自动创建表"),s("br"),a._v("\n功能：通过实例化MapperLocations获取配置值 追加配置文件中的 mapperLocations 属性值")]),a._v(" "),s("h2",{attrs:{id:"引入依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引入依赖"}},[a._v("#")]),a._v(" 引入依赖")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    <dependencies>\n        <dependency>\n            <groupId>cn.iosd</groupId>\n            <artifactId>simple-starter-datasource</artifactId>\n            <version>Version</version>\n        </dependency>\n    </dependencies>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h2",{attrs:{id:"配置项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置项"}},[a._v("#")]),a._v(" 配置项")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("simple:\n  datasource:\n    #自动创建数据库 缺省项为true \n    autoCreateDatabase: true\n    locations:\n      ## 开启实现MapperLocationsProvider接口获取配置值，实现接口追加配置文件中mapper-locations属性 缺省项为true\n      enabled: true\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h2",{attrs:{id:"功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[a._v("#")]),a._v(" 功能")]),a._v(" "),s("h3",{attrs:{id:"自动创建库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动创建库"}},[a._v("#")]),a._v(" 自动创建库")]),a._v(" "),s("p",[a._v("业务逻辑类：DatabaseInitializer"),s("br"),a._v("\n实现了ApplicationContextInitializer接口，用于在Spring应用程序上下文初始化时初始化数据库。"),s("br"),a._v("\n从应用程序上下文环境中获取数据库连接属性，并根据jdbcUrl解析出数据库名，然后执行创建数据库的SQL语句。")]),a._v(" "),s("h3",{attrs:{id:"分页插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分页插件"}},[a._v("#")]),a._v(" 分页插件")]),a._v(" "),s("p",[a._v("启用配置类效果代码：MybatisPlusConfig"),s("br"),a._v("\n使用：mybatis-plus分页插件")]),a._v(" "),s("h3",{attrs:{id:"分页请求参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分页请求参数"}},[a._v("#")]),a._v(" 分页请求参数")]),a._v(" "),s("p",[a._v("实体类：PageRequest"),s("br"),a._v("\n一个封装了分页请求参数的Java类，包含起始页、每页显示记录数、排序、查询条件参数等字段。")]),a._v(" "),s("h3",{attrs:{id:"工具类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工具类"}},[a._v("#")]),a._v(" 工具类")]),a._v(" "),s("p",[a._v("将自定义的分页对象PageRequest转换为mybatisPlus的分页对象Page"),s("br"),a._v("\n使用示例：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('    @Operation(summary = "Api-查询-分页")\n    @PostMapping("/api/page")\n    public Response<IPage<T>> apiPage(@RequestBody PageRequest<T> req) {\n        return Response.ok(service.page(DsConvertUtil.page(req), Wrappers.lambdaQuery(req.getData())));\n    }\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h3",{attrs:{id:"mybatis-自定义类型处理器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-自定义类型处理器"}},[a._v("#")]),a._v(" MyBatis 自定义类型处理器")]),a._v(" "),s("p",[a._v("将JsonNode类型映射为JSON字符串类型：JacksonTypeHandler"),s("br"),a._v("\n使用示例：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('    @Schema(description = "模块名列表")\n    @TableField(typeHandler = cn.iosd.starter.datasource.mybatis.handler.JacksonTypeHandler.class)\n    private JsonNode moduleNames;\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"mapperlocations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mapperlocations"}},[a._v("#")]),a._v(" MapperLocations")]),a._v(" "),s("h4",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[a._v("#")]),a._v(" 介绍")]),a._v(" "),s("p",[a._v("实例化MapperLocations获取配置值 覆盖配置文件中的 mapperLocations 属性值"),s("br"),a._v("\n解决：各个模块不同mapper-locations配置能在父级模块没有配置其需要的mapper-locations时能正常使用"),s("br"),a._v("\n注意项：当开启时，配置文件中的mapperLocations属性值可同时生效")]),a._v(" "),s("h4",{attrs:{id:"问题点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题点"}},[a._v("#")]),a._v(" 问题点")]),a._v(" "),s("p",[a._v("例")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("子模块工程所需 配置文件参数\nmybatis-plus.mapper-locations=classpath*:/cn/iosd/base/**/*Mapper.xml\n父模块依赖子模块，而父模块的配置文件参数实际为\nmybatis-plus.mapper-locations=classpath*:/cn/iosd/test/**/*Mapper.xml\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("父模块运行时，对于子模块调用的mapper接口将会报错：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Invalid bound statement (not found):\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("除非父模块配置包含子模块的参数，这样需要知道各个子模块所需配置，较为麻烦")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mybatis-plus.mapper-locations=classpath*:/cn/iosd/test/**/*Mapper.xml,classpath*:/cn/iosd/base/**/*Mapper.xml\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"解决示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决示例"}},[a._v("#")]),a._v(" 解决示例")]),a._v(" "),s("p",[a._v("子模块实例化MapperLocations")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('    @Bean\n    public MapperLocations paramMapperLocations() {\n        return new MapperLocations("classpath*:/cn/iosd/base/param/mapper/**/*Mapper.xml");\n    }\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("父模块实现MapperLocationsProvider")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('    @Bean\n    public MapperLocations collectionMapperLocations() {\n        return new MapperLocations("classpath*:/cn/iosd/test/**/*Mapper.xml");\n    }\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);