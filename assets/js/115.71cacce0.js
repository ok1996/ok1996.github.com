(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{729:function(s,e,a){"use strict";a.r(e);var n=a(7),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),e("p",[s._v("提供 注解简化使用：分布式锁、分布式幂等、分布式限流器"),e("br"),s._v("\n提供 分布式加锁、解锁等服务类"),e("br"),s._v("\n提供 常用的对象缓存的常用操作服务类"),e("br"),s._v("\n提供 CacheManager并配置Cacheable注解常用配置及自定义CacheName对应配置")]),s._v(" "),e("h2",{attrs:{id:"分布式幂等和锁的主要区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式幂等和锁的主要区别"}},[s._v("#")]),s._v(" 分布式幂等和锁的主要区别")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("-")]),s._v(" "),e("th",[s._v("锁")]),s._v(" "),e("th",[s._v("分布式幂等")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("目的")]),s._v(" "),e("td",[s._v("保护资源完整性，防止多线程导致数据竞争")]),s._v(" "),e("td",[s._v("用于保证操作的一致性，防止重复请求影响系统状态")])]),s._v(" "),e("tr",[e("td",[s._v("范围")]),s._v(" "),e("td",[s._v("同步机制，用于控制对共享资源的并发访问")]),s._v(" "),e("td",[s._v("分布式系统设计理念，用于处理分布式系统中的重复请求")])])])]),s._v(" "),e("h2",{attrs:{id:"引入依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#引入依赖"}},[s._v("#")]),s._v(" 引入依赖")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    <dependencies>\n        <dependency>\n            <groupId>cn.iosd</groupId>\n            <artifactId>simple-starter-redisson</artifactId>\n            <version>Version</version>\n        </dependency>\n    </dependencies>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"配置项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置项"}},[s._v("#")]),s._v(" 配置项")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("simple:\n  redisson:\n    #分布式锁 缺省项为false\n    enabled: true\n    type: standalone\n    config:\n      ## 单体模式\n      standalone:\n        address: redis://127.0.0.1:6379\n        password:\n        database: 0\n      ## 主从模式\n      masterSlave:\n        masterAddress: redis://127.0.0.1:6379\n        slaveAddresses:\n          - redis://127.0.0.1:6379\n        password:\n        database: 0\n      ## 哨兵配置\n      sentinel:\n        sentinelMasterName: myMaster\n        sentinelAddresses:\n          - redis://127.0.0.1:26379\n          - redis://127.0.0.2:26379\n        password:\n        database: 0\n      ## 集群方式\n      cluster:\n        clusterAddresses:\n          - redis://127.0.0.1:7000\n          - redis://127.0.0.1:7001\n          - redis://127.0.0.2:7000\n        password:\n    #Cacheable注解自定义配置\n    cacheable:\n      #缺省项为false,优先级小于simple.redisson.enabled\n      enabled: true\n      config:\n        #自定义cacheName及过期时间\n        cacheExpiresAfterFiveMinutes:\n          ttl: 300000\n          maxIdleTime: 300000\n        cacheExpiresAfterTenSecond:\n          ttl: 10000\n          maxIdleTime: 10000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br")])]),e("h2",{attrs:{id:"功能项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#功能项"}},[s._v("#")]),s._v(" 功能项")]),s._v(" "),e("h3",{attrs:{id:"注解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注解"}},[s._v("#")]),s._v(" 注解")]),s._v(" "),e("h4",{attrs:{id:"分布式幂等"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式幂等"}},[s._v("#")]),s._v(" 分布式幂等")]),s._v(" "),e("p",[s._v("注解： @DistributedIdempotent")]),s._v(" "),e("h5",{attrs:{id:"使用示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@DistributedIdempotent\n\n@DistributedIdempotent(value = "drp", message = "请求重复！", expireTime = 5)\n\n@DistributedIdempotent(param = "#keyName", includePointMd5 = false, message = "请求重复！", expireTime = 5, executionFinishedUnlock = false)\npublic Response<?> decrement(String keyName) {\n   return Response.ok();\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h5",{attrs:{id:"各字段说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#各字段说明"}},[s._v("#")]),s._v(" 各字段说明")]),s._v(" "),e("ul",[e("li",[s._v("value：key固定值")]),s._v(" "),e("li",[s._v("param：key动态参数值，支持el表达式，默认为空不拼接（若el获取不到对应值默认：DV）")]),s._v(" "),e("li",[s._v("includePointMd5：key后缀，是否拼接MD5（从切点获取方法参数和实例字符串生成对象，转为md5）")]),s._v(" "),e("li",[s._v("message：失败的提示信息")]),s._v(" "),e("li",[s._v("acquireTimeout：获取锁的最长等待时间 默认0")]),s._v(" "),e("li",[s._v("expireTime：获取后持有锁的最长时间 默认10")]),s._v(" "),e("li",[s._v("unit：时间单位 默认秒")]),s._v(" "),e("li",[s._v("executionFinishedUnlock：是否在业务执行结束后解锁,默认true(false：若干时间内防重复提交功能 true：业务逻辑执行期间内防重复提交功能)")])]),s._v(" "),e("h5",{attrs:{id:"key说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#key说明"}},[s._v("#")]),s._v(" key说明")]),s._v(" "),e("p",[s._v("includePointMd5为true：前缀+固定值+动态参数值+md5.get()"),e("br"),s._v("\nincludePointMd5为true且param不传：前缀+固定值+md5.get()")]),s._v(" "),e("p",[s._v("includePointMd5为false：前缀+固定值+动态参数值"),e("br"),s._v("\nincludePointMd5为false且param不传：前缀+固定值"),e("br"),s._v("\neg:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("前缀为 SimpleRI:\n\nSimpleRI:固定值:动态参数值:c5a2e....4a0\nSimpleRI:固定值:c5a2e....4a0\n\nSimpleRI:固定值:动态参数值\nSimpleRI:固定值\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h5",{attrs:{id:"md5说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#md5说明"}},[s._v("#")]),s._v(" MD5说明")]),s._v(" "),e("p",[s._v("从切点获取方法参数和实例字符串生成对象，转为md5"),e("br"),s._v("\n生成对象：MethodContext")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("MethodContext[argMap={keyName=cda6666}, name=public cn.iosd.starter.web.domain.Response<?> cn.iosd.demo.redisson.controller.AnnotationIdempotentController.decrementReqPara(java.lang.String)]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("生成md5:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" Supplier<String> md5 = () -> DigestUtils.md5DigestAsHex(context.toString().getBytes());\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h5",{attrs:{id:"解锁说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解锁说明"}},[s._v("#")]),s._v(" 解锁说明")]),s._v(" "),e("p",[s._v("executionFinishedUnlock")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("等于true时： 业务执行结束后解锁：业务逻辑执行期间内防重复提交功能  \n等于false时：业务执行结束后不解锁，等待自动过期：若干时间内防重复提交功能  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h5",{attrs:{id:"使用说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用说明"}},[s._v("#")]),s._v(" 使用说明")]),s._v(" "),e("p",[s._v("直接使用注解无需为各字段赋值即可保证分布式幂等：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    主要原因：默认开启了md5，md5由切点获取方法参数和实例字符串生成 \nkey为 \tSimpleRI:IC:c5a2e****\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("入参为实体，为实体对象的单个参数（前提参数值不为空，否则生成的key可能重复）保证分布式幂等：\n注解字段使用param，并且关闭md5")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    /**\n     * key动态参数值，支持el表达式\n     *\n     * <pre>\n     *  1.获取方法参数中的某个值\n     *      void test(String id)  => #id\n     *  2.获取对象参数中的某个值\n     *      void test(Vo vo)  => #vo.id\n     *  3.参数值获取不到，默认为：DV\n     *      void test(String id)  => #im\n     *  4.默认空，不拼接到key中\n     * </pre>\n     */\n    String param() default "";\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("入参为实体，为实体对象的单个参数（参数值可能为空）保证分布式幂等：\n注解字段使用value，param，并且关闭md5")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("value：key固定值 自定义取值全局唯一\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"分布式锁"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式锁"}},[s._v("#")]),s._v(" 分布式锁")]),s._v(" "),e("p",[s._v("注解： @DistributedLock")]),s._v(" "),e("h5",{attrs:{id:"使用示例-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用示例-2"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@DistributedLock\n\n@DistributedLock(value = "demo", param = "#keyName", leaseTime = 105)\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h5",{attrs:{id:"各字段说明-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#各字段说明-2"}},[s._v("#")]),s._v(" 各字段说明")]),s._v(" "),e("ul",[e("li",[s._v("value：key固定值")]),s._v(" "),e("li",[s._v("param：key动态参数值，支持el表达式，默认为空不拼接（若el获取不到对应值默认：DV）")]),s._v(" "),e("li",[s._v("includePointMd5：key后缀，是否拼接MD5（从切点获取方法参数和实例字符串生成对象，转为md5）")]),s._v(" "),e("li",[s._v("leaseTime：锁的有效时间-秒")])]),s._v(" "),e("h5",{attrs:{id:"key说明-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#key说明-2"}},[s._v("#")]),s._v(" key说明")]),s._v(" "),e("p",[s._v("includePointMd5为true：前缀+固定值+动态参数值+md5.get()"),e("br"),s._v("\nincludePointMd5为true且param不传：前缀+固定值+md5.get()")]),s._v(" "),e("p",[s._v("includePointMd5为false：前缀+固定值+动态参数值"),e("br"),s._v("\nincludePointMd5为false且param不传：前缀+固定值"),e("br"),s._v("\neg:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("前缀为 SimpleRL:\n\nSimpleRL:固定值:动态参数值:c5a2e....4a0\nSimpleRL:固定值:c5a2e....4a0\n\nSimpleRL:固定值:动态参数值\nSimpleRL:固定值\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h5",{attrs:{id:"md5说明-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#md5说明-2"}},[s._v("#")]),s._v(" MD5说明")]),s._v(" "),e("p",[s._v("如上")]),s._v(" "),e("h5",{attrs:{id:"解锁说明-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解锁说明-2"}},[s._v("#")]),s._v(" 解锁说明")]),s._v(" "),e("p",[s._v("leaseTime")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("在获取到锁之后，该锁会在指定的leaseTime时间后自动释放，即锁的持有时间。\n如果在这个时间内业务执行完毕，那么在finally块中的lock.unlock()会手动释放锁，如果在这个时间内业务没有执行完毕，锁也会自动释放\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"分布式限流器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式限流器"}},[s._v("#")]),s._v(" 分布式限流器")]),s._v(" "),e("p",[s._v("注解：@DistributedRateLimiter")]),s._v(" "),e("h5",{attrs:{id:"使用示例-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用示例-3"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("@DistributedRateLimiter\n\n@DistributedRateLimiter(type = RateType.PER_CLIENT)\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h5",{attrs:{id:"各字段说明-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#各字段说明-3"}},[s._v("#")]),s._v(" 各字段说明")]),s._v(" "),e("ul",[e("li",[s._v("value：key固定值")]),s._v(" "),e("li",[s._v("param：key动态参数值，支持el表达式，默认为空不拼接（若el获取不到对应值默认：DV）")]),s._v(" "),e("li",[s._v("includePointMd5：key后缀，是否拼接MD5（从切点获取方法参数和实例字符串生成对象，转为md5）")]),s._v(" "),e("li",[s._v("rate：速率(即：在有效时间单位内通过的数量)")]),s._v(" "),e("li",[s._v("rateTime：有效时间 默认1")]),s._v(" "),e("li",[s._v("timeUnit：时间单位 默认秒")]),s._v(" "),e("li",[s._v("message：失败提示信息")]),s._v(" "),e("li",[s._v("type：限流类型 默认全局")])]),s._v(" "),e("h5",{attrs:{id:"key说明-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#key说明-3"}},[s._v("#")]),s._v(" key说明")]),s._v(" "),e("p",[s._v("includePointMd5为true：前缀+固定值+动态参数值+md5.get()"),e("br"),s._v("\nincludePointMd5为true且param不传：前缀+固定值+md5.get()")]),s._v(" "),e("p",[s._v("includePointMd5为false：前缀+固定值+动态参数值"),e("br"),s._v("\nincludePointMd5为false且param不传：前缀+固定值"),e("br"),s._v("\neg:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("前缀\n单客户端  SimpleRRC: \n全局      SimpleRRG:\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h5",{attrs:{id:"md5说明-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#md5说明-3"}},[s._v("#")]),s._v(" MD5说明")]),s._v(" "),e("p",[s._v("如上")]),s._v(" "),e("h5",{attrs:{id:"限流类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#限流类型"}},[s._v("#")]),s._v(" 限流类型")]),s._v(" "),e("p",[s._v("使用org.redisson.api.RateType\n区分为单客户端、全局")]),s._v(" "),e("h3",{attrs:{id:"服务类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务类"}},[s._v("#")]),s._v(" 服务类")]),s._v(" "),e("h4",{attrs:{id:"分布式锁服务类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式锁服务类"}},[s._v("#")]),s._v(" 分布式锁服务类")]),s._v(" "),e("p",[s._v("注入使用")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    @Autowired(required = false)\n    private RedissonLockService redissonLockService;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("加锁操作")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    /**\n     * 加锁操作 （设置锁的有效时间）\n     *\n     * @param lockName  锁名称\n     * @param leaseTime 锁有效时间-秒\n     */\n     redissonLockService.lock(lockName, leaseTime);\n\n    /**\n     * 加锁操作(tryLock锁，有等待时间）\n     *\n     * @param lockName  锁名称\n     * @param leaseTime 锁有效时间\n     * @param waitTime  等待时间\n     */\n     redissonLockService.tryLock(lockName, leaseTime, waitTime)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("p",[s._v("解锁操作")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    /**\n     * 解锁\n     *\n     * @param lockName 锁名称\n     */\n     redissonLockService.unlock(lockName);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h4",{attrs:{id:"缓存服务类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存服务类"}},[s._v("#")]),s._v(" 缓存服务类")]),s._v(" "),e("p",[s._v("注入使用")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    @Autowired(required = false)\n    private RedissonCacheService redissonCacheService;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("常用示例代码")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('  @Operation(summary = "Object-获取")\n    @GetMapping("/object/{key}")\n    public Response<PersonVo> getObject(@PathVariable String key) {\n        return Response.ok(redissonCacheService.getObject(key));\n    }\n\n    @Operation(summary = "Object-保存")\n    @PostMapping("/object/{key}")\n    public Response<?> setObject(@PathVariable String key, @RequestBody PersonVo value) {\n        redissonCacheService.setObject(key, value);\n        return Response.ok();\n    }\n\n    @Operation(summary = "List-获取")\n    @GetMapping("/list/{key}")\n    public Response<List<PersonVo>> getList(@PathVariable String key) {\n        return Response.ok(redissonCacheService.getList(key));\n    }\n\n    @Operation(summary = "List-保存")\n    @PostMapping("/list/{key}")\n    public Response<?> setList(@PathVariable String key, @RequestBody List<PersonVo> value) {\n        redissonCacheService.setList(key, value);\n        return Response.ok();\n    }\n\n    @Operation(summary = "Map-获取")\n    @GetMapping("/map/{key}")\n    public Response<Map<String, PersonVo>> getMap(@PathVariable String key) {\n        return Response.ok(redissonCacheService.getMap(key));\n    }\n\n    @Operation(summary = "Map-保存")\n    @PostMapping("/map/{key}")\n    public Response<?> setMap(@PathVariable String key, @RequestBody PersonVo value) {\n        Map save = new HashMap(2);\n        save.put(key, value);\n        redissonCacheService.setMap(key, save);\n        return Response.ok();\n    }\n\n    @Operation(summary = "删除")\n    @DeleteMapping("/{key}")\n    public Response<?> delete(@PathVariable("key") String key) {\n        redissonCacheService.delete(key);\n        return Response.ok();\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br")])]),e("h3",{attrs:{id:"获取redisson客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取redisson客户端"}},[s._v("#")]),s._v(" 获取Redisson客户端")]),s._v(" "),e("p",[s._v("注入")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    @Autowired(required = false)\n    private RedissonManager redissonManager;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("获取客户端")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    redissonManager.getRedisson()\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"redisson连接类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redisson连接类型"}},[s._v("#")]),s._v(" redisson连接类型")]),s._v(" "),e("p",[s._v("支持：standalone、sentinel、cluster、masterSlave")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("simple:\n  redisson:\n    #缺省项为false\n    enabled: true\n    type: standalone\n    config:\n      ## 单体模式\n      standalone:\n        address: redis://127.0.0.1:6379\n        password:\n        database: 0\n      ## 主从模式\n      masterSlave:\n        masterAddress: redis://127.0.0.1:6379\n        slaveAddresses:\n          - redis://127.0.0.1:6379\n        password:\n        database: 0\n      ## 哨兵配置\n      sentinel:\n        sentinelMasterName: myMaster\n        sentinelAddresses:\n          - redis://127.0.0.1:26379\n          - redis://127.0.0.2:26379\n        password:\n        database: 0\n      ## 集群方式\n      cluster:\n        clusterAddresses:\n          - redis://127.0.0.1:7000\n          - redis://127.0.0.1:7001\n          - redis://127.0.0.2:7000\n        password:\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br")])]),e("h3",{attrs:{id:"使用注解cacheable"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用注解cacheable"}},[s._v("#")]),s._v(" 使用注解Cacheable")]),s._v(" "),e("p",[s._v("已提供的cacheName及对应过期时间配置")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cacheExpiresAfterTenMinutes:缓存时间10分钟\ncacheExpiresAfterOneHour:缓存时间60分钟\ncacheNeverExpires:未设置缓存失效时间\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("可在配置文件中设置自定义cacheName及对应过期时间配置"),e("br"),s._v("\n如下自定义cacheExpiresAfterFiveMinutes：缓存时间5分钟"),e("br"),s._v("\n自定义cacheExpiresAfterTenSecond：缓存时间10秒"),e("br"),s._v("\n例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("simple:\n  redisson:\n    enabled: true\n    type: standalone\n    config:\n      ## 单体模式\n      standalone:\n        address: redis://127.0.0.1:6379\n        password:\n        database: 0\n    #Cacheable注解自定义配置\n    cacheable:\n      #缺省项为false,优先级小于simple.redisson.enabled\n      enabled: true\n      config:\n        #自定义cacheName及过期时间\n        cacheExpiresAfterFiveMinutes:\n          ttl: 300000\n          maxIdleTime: 300000\n        cacheExpiresAfterTenSecond:\n          ttl: 10000\n          maxIdleTime: 10000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])]),e("p",[s._v("在服务层中使用示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('    @Cacheable(key = "#keyName + \'FiveMinutes\'", cacheNames = "cacheExpiresAfterFiveMinutes", condition = "#keyName.length()>2")\n    public String annotateTestCacheNameFiveMinutes(String keyName) {\n        log.info("cacheExpiresAfterFiveMinutes:{}", keyName);\n        return keyName;\n    }\n\n    @Cacheable(key = "#keyName + \'TenSecond\'", cacheNames = "cacheExpiresAfterTenSecond", condition = "#keyName.length()>2")\n    public String annotateTestCacheNameTenSecond(String keyName) {\n        log.info("cacheExpiresAfterTenSecond:{}", keyName);\n        return keyName;\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);