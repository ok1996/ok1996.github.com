(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{251:function(s,a,n){s.exports=n.p+"assets/img/simple-starter-package-xiaoguo-2023-5-2-0.b4aa897c.png"},700:function(s,a,n){"use strict";n.r(a);var e=n(7),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("自定义Maven构建打包逻辑，将常用脚本及可执行文件统一打包"),a("br"),s._v("\n在执行mvn package或mvn install时打包出 xxx--deploy.zip部署压缩包"),a("br"),s._v("\n压缩包包含：服务启动脚本、可执行Jar包、配置文件、git版本文件（可选）")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("文件名")]),s._v(" "),a("th",[s._v("功能")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("application.yml")]),s._v(" "),a("td",[s._v("配置文件")]),s._v(" "),a("td",[s._v("工程源码中的配置文件")])]),s._v(" "),a("tr",[a("td",[s._v("config")]),s._v(" "),a("td",[s._v("配置文件夹(可选)")]),s._v(" "),a("td",[s._v("工程配置源码中的文件夹-目录下为子配置文件")])]),s._v(" "),a("tr",[a("td",[s._v("docker-compose.yml")]),s._v(" "),a("td",[s._v("Docker编排文件")]),s._v(" "),a("td",[s._v("网络模式为Host，将配置文件映射进容器中")])]),s._v(" "),a("tr",[a("td",[s._v("Dockerfile")]),s._v(" "),a("td",[s._v("Docker镜像构建文件")]),s._v(" "),a("td",[s._v("基于openjdk:17-oracle")])]),s._v(" "),a("tr",[a("td",[s._v("git.properties")]),s._v(" "),a("td",[s._v("git版本文件(可选)")]),s._v(" "),a("td",[s._v("输出构建时的Git版本信息")])]),s._v(" "),a("tr",[a("td",[s._v("Readme.md")]),s._v(" "),a("td",[s._v("操作说明")]),s._v(" "),a("td",[s._v("各脚本使用方式说明")])]),s._v(" "),a("tr",[a("td",[s._v("shell_java_start.sh")]),s._v(" "),a("td",[s._v("Shell启动脚本")]),s._v(" "),a("td",[s._v("使用原生Java命令启动")])]),s._v(" "),a("tr",[a("td",[s._v("shell_java_stop.sh")]),s._v(" "),a("td",[s._v("Shell关闭脚本")]),s._v(" "),a("td",[s._v("根据运行Pid进行关闭进程")])]),s._v(" "),a("tr",[a("td",[s._v("xxx-exec.jar")]),s._v(" "),a("td",[s._v("Jar源文件")]),s._v(" "),a("td",[s._v("可执行Jar包")])]),s._v(" "),a("tr",[a("td",[s._v("win_java_start.bat")]),s._v(" "),a("td",[s._v("Windows启动脚本")]),s._v(" "),a("td",[s._v("使用原生Java命令启动")])])])]),s._v(" "),a("h2",{attrs:{id:"模板源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板源码"}},[s._v("#")]),s._v(" 模板源码")]),s._v(" "),a("p",[s._v("参考模块："),a("br"),s._v(" "),a("a",{attrs:{href:"https://github.com/ok1996/ok-system-simple/tree/main/simple-demo/simple-demo-package",target:"_blank",rel:"noopener noreferrer"}},[s._v("simple-demo-package"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"使用说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用说明"}},[s._v("#")]),s._v(" 使用说明")]),s._v(" "),a("h3",{attrs:{id:"pom-xml文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pom-xml文件"}},[s._v("#")]),s._v(" Pom.xml文件")]),s._v(" "),a("h4",{attrs:{id:"父类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#父类"}},[s._v("#")]),s._v(" 父类")]),s._v(" "),a("p",[s._v("方式一："),a("br"),s._v("\n需要继承spring-boot-starter-parent"),a("br"),s._v('\n原因：resources资源文件下的启动脚本中使用 Pom.xml变量 "@xx@"')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>xxxx</version>\n    </parent>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"版本标识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本标识"}},[s._v("#")]),s._v(" 版本标识")]),s._v(" "),a("p",[s._v("需要声明本工程版本号"),a("br"),s._v("\n原因：docker启动脚本中构建容器版本需使用变量@project.version@")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    <version>2023.5.2.0-SNAPSHOT</version>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"依赖引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖引入"}},[s._v("#")]),s._v(" 依赖引入")]),s._v(" "),a("p",[s._v("需要引入simple-starter-package依赖"),a("br"),s._v("\n原因：使用依赖中的resources文件夹下的资源文件")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("文件名")]),s._v(" "),a("th",[s._v("功能")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("docker-compose.yml")]),s._v(" "),a("td",[s._v("Docker编排文件（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("首次启动将自动构建镜像，若在版本不变下需要更新镜像需先移除镜像")])]),s._v(" "),a("tr",[a("td",[s._v("Dockerfile")]),s._v(" "),a("td",[s._v("Docker镜像构建文件（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("基于openjdk:17-oracle，将可执行Jar包复制进镜像中运行")])]),s._v(" "),a("tr",[a("td",[s._v("logback-spring.xml")]),s._v(" "),a("td",[s._v("日志配置")]),s._v(" "),a("td",[s._v("配置按照每天生成日志文件")])]),s._v(" "),a("tr",[a("td",[s._v("Readme.md")]),s._v(" "),a("td",[s._v("操作说明（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("各脚本使用方式说明")])]),s._v(" "),a("tr",[a("td",[s._v("shell_java_start.sh")]),s._v(" "),a("td",[s._v("Shell启动脚本（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("使用原生Java命令启动，运行可执行Jar包")])]),s._v(" "),a("tr",[a("td",[s._v("shell_java_stop.sh")]),s._v(" "),a("td",[s._v("Shell关闭脚本（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("根据运行Pid进行关闭进程")])]),s._v(" "),a("tr",[a("td",[s._v("win_java_start.bat")]),s._v(" "),a("td",[s._v("Windows启动脚本（引用Pom.xml变量）")]),s._v(" "),a("td",[s._v("使用原生Java命令启动，运行可执行Jar包")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("        <dependency>\n            <groupId>cn.iosd</groupId>\n            <artifactId>simple-starter-package</artifactId>\n        </dependency>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"依赖声明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖声明"}},[s._v("#")]),s._v(" 依赖声明")]),s._v(" "),a("p",[s._v("使用依赖声明，可减免依赖引入时都需要配置版本号")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    \x3c!-- 依赖声明 --\x3e\n    <dependencyManagement>\n        <dependencies>\n            \x3c!-- SimpleDependencies 依赖配置 --\x3e\n            <dependency>\n                <groupId>cn.iosd</groupId>\n                <artifactId>simple-dependencies</artifactId>\n                <version>${ok-simple.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"构建配置-必填"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建配置-必填"}},[s._v("#")]),s._v(" 构建配置-必填")]),s._v(" "),a("p",[s._v("指定finalName：原因为各脚本有将构建出的可执行jar进行操作"),a("br"),s._v("\n指定classifier为exec：原因为各脚本有将构建出的可执行jar（包含后缀exec）进行操作"),a("br"),s._v("\n插件maven-assembly-plugin：引入自定义压缩包逻辑文件"),a("br"),s._v("\n插件声明pluginManagement：指定使用自定义压缩包逻辑文件-此声明可放置在一级Pom中，子工程便不需要再写")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    <build>\n        <finalName>${project.artifactId}</finalName>\n        <resources>\n            <resource>\n                <directory>src/main/resources</directory>\n                <filtering>true</filtering>\n            </resource>\n        </resources>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n                <configuration>\n                    <includeSystemScope>true</includeSystemScope>\n                    \x3c!-- SpringBoot多模块打包:spring-boot工程打包编译时，会生成两种jar包，一种是普通的jar，另一种是可执行jar--\x3e\n                    <classifier>exec</classifier>\n                </configuration>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>repackage</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>\n\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-assembly-plugin</artifactId>\n                <dependencies>\n                    \x3c!-- 包含simple-assembly文件，自定义压缩包逻辑 --\x3e\n                    <dependency>\n                        <groupId>cn.iosd</groupId>\n                        <artifactId>simple-starter-package</artifactId>\n                        <version>${ok-simple.version}</version>\n                    </dependency>\n                </dependencies>\n            </plugin>\n        </plugins>\n\n        <pluginManagement>\n            <plugins>\n\t\t\t    \x3c!-- 插件声明 可放在首层 指定使用simple-assembly --\x3e\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-assembly-plugin</artifactId>\n                    <executions>\n                        <execution>\n                            <id>deploy</id>\n                            <phase>package</phase>\n                            <goals>\n                                <goal>single</goal>\n                            </goals>\n                            <configuration>\n                                <finalName>${project.artifactId}</finalName>\n                                <descriptorRefs>\n                                    <descriptorRef>simple-assembly</descriptorRef>\n                                </descriptorRefs>\n                            </configuration>\n                        </execution>\n                    </executions>\n                </plugin>\n            </plugins>\n        </pluginManagement>\n    </build>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br")])]),a("h4",{attrs:{id:"构建配置-可选"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建配置-可选"}},[s._v("#")]),s._v(" 构建配置-可选")]),s._v(" "),a("p",[s._v("可选构建时增加输出增加git版本文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("            \x3c!-- 构建输出增加git版本文件 --\x3e\n            <plugin>\n                <groupId>io.github.git-commit-id</groupId>\n                <artifactId>git-commit-id-maven-plugin</artifactId>\n            </plugin>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("若父类不是继承 spring-boot-starter-parent 则需要在 插件声明中添加")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("                \x3c!-- 插件声明 可放在首层 打包时生成git.properties（可选） --\x3e\n                <plugin>\n                    <groupId>io.github.git-commit-id</groupId>\n                    <artifactId>git-commit-id-maven-plugin</artifactId>\n                    <version>5.0.1</version>\n                    <executions>\n                        <execution>\n                            <goals>\n                                <goal>revision</goal>\n                            </goals>\n                        </execution>\n                    </executions>\n                    <configuration>\n                        <verbose>true</verbose>\n                        <dateFormat>yyyy-MM-dd'T'HH:mm:ssZ</dateFormat>\n                        <generateGitPropertiesFile>true</generateGitPropertiesFile>\n                        <generateGitPropertiesFilename>${project.build.outputDirectory}/git.properties</generateGitPropertiesFilename>\n                    </configuration>\n                </plugin>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),a("p",[s._v("把项目配置文件复制到压缩包中，resources资源夹列表如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("resources\n|--application.yml 配置文件\n|--config          配置文件夹下所有文件\n   |--*.*           \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"效果如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#效果如下"}},[s._v("#")]),s._v(" 效果如下")]),s._v(" "),a("p",[s._v("执行 mvn install后在target目录下生成xxx-deploy.zip部署包\n"),a("img",{attrs:{src:n(251),alt:"效果图"}})])])}),[],!1,null,null,null);a.default=t.exports}}]);