(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{647:function(s,n,a){"use strict";a.r(n);var e=a(7),r=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"脚本逻辑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#脚本逻辑"}},[s._v("#")]),s._v(" 脚本逻辑")]),s._v(" "),n("p",[s._v('写一个shell脚本，执行的时候参数为："镜像名称:版本号"\n执行后：\n1.服务器检查docker是否存在，不存在则提示异常\n2.检查输入参数是否为空。为空则提示请输入 镜像名称:版本号\n3.服务器进行下载镜像 docker pull 镜像名称:版本号，完成打印日志到屏幕上\n4.下载完成后对镜像进行打包 docker save -o xxx.tar 镜像名称:版本号，完成打印日志到屏幕上\n5.删除镜像 docker rmi 镜像名称:版本号，完成打印日志到屏幕上')]),s._v(" "),n("h2",{attrs:{id:"脚本内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#脚本内容"}},[s._v("#")]),s._v(" 脚本内容")]),s._v(" "),n("p",[s._v("download_image.sh")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('#!/bin/bash\n\n# 检查docker是否存在\nif ! command -v docker &> /dev/null; then\n    echo "异常：Docker未安装或未配置环境变量"\n    exit 1\nfi\n\n# 检查输入参数\nif [ -z "$1" ]; then\n    echo "请输入 镜像名称:版本号"\n    exit 1\nfi\n\nimage_name="$1"\n\n# 下载镜像\necho "开始下载镜像 $image_name"\ndocker pull "$image_name"\n\n# 提取镜像名称和版本号\nIFS=\':\' read -r -a name_parts <<< "$image_name"\nname="${name_parts[0]}"\nversion="${name_parts[1]}"\n\n# 替换冒号和斜杠为下划线\nname_with_underscore="$(echo "$name" | sed \'s/[:/]/_/g\')"\nimage_file="${name_with_underscore}_${version}.tar"\n\n# 打包镜像\necho "开始打包镜像 $image_name 到文件 $image_file"\ndocker save -o "$image_file" "$image_name"\n\n# 删除镜像\necho "开始删除镜像 $image_name"\ndocker rmi "$image_name"\n\necho "脚本执行完成"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])]),n("h2",{attrs:{id:"执行命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#执行命令"}},[s._v("#")]),s._v(" 执行命令")]),s._v(" "),n("p",[s._v("赋权")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("chmod +x download_image.sh  \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("例：镜像 redis:7.0.11")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("./download_image.sh redis:7.0.11\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);n.default=r.exports}}]);