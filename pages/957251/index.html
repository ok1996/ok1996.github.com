<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Springboot集成kafka | 北山小库</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/20230310/logo.3mn8xlqm9oy0.webp">
    <meta name="description" content="小渔村的板砖师傅">
    <meta name="keywords" content="小渔村的板砖师傅">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.9f968600.css" as="style"><link rel="preload" href="/assets/js/app.0ac31a06.js" as="script"><link rel="preload" href="/assets/js/4.1fc6d7d0.js" as="script"><link rel="preload" href="/assets/js/10.f1d01818.js" as="script"><link rel="preload" href="/assets/js/7.b3c10a4a.js" as="script"><link rel="prefetch" href="/assets/js/100.7a639f30.js"><link rel="prefetch" href="/assets/js/101.83332b22.js"><link rel="prefetch" href="/assets/js/102.caa8daec.js"><link rel="prefetch" href="/assets/js/103.eb9ffc17.js"><link rel="prefetch" href="/assets/js/104.9a99af59.js"><link rel="prefetch" href="/assets/js/105.2be3d7b7.js"><link rel="prefetch" href="/assets/js/106.91ff66b6.js"><link rel="prefetch" href="/assets/js/107.afabf799.js"><link rel="prefetch" href="/assets/js/108.db6c1410.js"><link rel="prefetch" href="/assets/js/109.37da3a3d.js"><link rel="prefetch" href="/assets/js/11.85daa8c7.js"><link rel="prefetch" href="/assets/js/110.70c879fb.js"><link rel="prefetch" href="/assets/js/111.3a8a43c8.js"><link rel="prefetch" href="/assets/js/112.d9cbf54a.js"><link rel="prefetch" href="/assets/js/113.b3f203d3.js"><link rel="prefetch" href="/assets/js/114.813ccc4a.js"><link rel="prefetch" href="/assets/js/12.73b0d0dd.js"><link rel="prefetch" href="/assets/js/13.2eece7b7.js"><link rel="prefetch" href="/assets/js/14.839d9cf9.js"><link rel="prefetch" href="/assets/js/15.cdfebf60.js"><link rel="prefetch" href="/assets/js/16.f5b22f10.js"><link rel="prefetch" href="/assets/js/17.49846152.js"><link rel="prefetch" href="/assets/js/18.73a906f1.js"><link rel="prefetch" href="/assets/js/19.b603675c.js"><link rel="prefetch" href="/assets/js/2.63a2a09a.js"><link rel="prefetch" href="/assets/js/20.f5dc62aa.js"><link rel="prefetch" href="/assets/js/21.17fed66c.js"><link rel="prefetch" href="/assets/js/22.b50cee3a.js"><link rel="prefetch" href="/assets/js/23.8fd68c58.js"><link rel="prefetch" href="/assets/js/24.f57b0389.js"><link rel="prefetch" href="/assets/js/25.edc8221a.js"><link rel="prefetch" href="/assets/js/26.0961b744.js"><link rel="prefetch" href="/assets/js/27.e4e13838.js"><link rel="prefetch" href="/assets/js/28.40b850e8.js"><link rel="prefetch" href="/assets/js/29.e23a1c91.js"><link rel="prefetch" href="/assets/js/3.09e136f7.js"><link rel="prefetch" href="/assets/js/30.ac086873.js"><link rel="prefetch" href="/assets/js/31.a968048a.js"><link rel="prefetch" href="/assets/js/32.ed8b8691.js"><link rel="prefetch" href="/assets/js/33.44090e3a.js"><link rel="prefetch" href="/assets/js/34.4bc317c9.js"><link rel="prefetch" href="/assets/js/35.8b08210a.js"><link rel="prefetch" href="/assets/js/36.651667b9.js"><link rel="prefetch" href="/assets/js/37.6f96ac01.js"><link rel="prefetch" href="/assets/js/38.240235f1.js"><link rel="prefetch" href="/assets/js/39.9d56f0e7.js"><link rel="prefetch" href="/assets/js/40.3656acbd.js"><link rel="prefetch" href="/assets/js/41.8ca53da4.js"><link rel="prefetch" href="/assets/js/42.9fe1cc02.js"><link rel="prefetch" href="/assets/js/43.155eb8e0.js"><link rel="prefetch" href="/assets/js/44.8574ef50.js"><link rel="prefetch" href="/assets/js/45.4c0932d8.js"><link rel="prefetch" href="/assets/js/46.5e000bec.js"><link rel="prefetch" href="/assets/js/47.67d45c12.js"><link rel="prefetch" href="/assets/js/48.26502de5.js"><link rel="prefetch" href="/assets/js/49.fa8c2be3.js"><link rel="prefetch" href="/assets/js/5.c01f781f.js"><link rel="prefetch" href="/assets/js/50.300ea69a.js"><link rel="prefetch" href="/assets/js/51.e50443e1.js"><link rel="prefetch" href="/assets/js/52.c4ad5105.js"><link rel="prefetch" href="/assets/js/53.672df371.js"><link rel="prefetch" href="/assets/js/54.2b09d3b9.js"><link rel="prefetch" href="/assets/js/55.5c88e091.js"><link rel="prefetch" href="/assets/js/56.8581e2ac.js"><link rel="prefetch" href="/assets/js/57.79e0cd66.js"><link rel="prefetch" href="/assets/js/58.4119fe49.js"><link rel="prefetch" href="/assets/js/59.bd49cd17.js"><link rel="prefetch" href="/assets/js/6.bf442f2c.js"><link rel="prefetch" href="/assets/js/60.7c205992.js"><link rel="prefetch" href="/assets/js/61.0ade3cfa.js"><link rel="prefetch" href="/assets/js/62.d8455b2a.js"><link rel="prefetch" href="/assets/js/63.40b5963b.js"><link rel="prefetch" href="/assets/js/64.1101e222.js"><link rel="prefetch" href="/assets/js/65.e3a8bdd8.js"><link rel="prefetch" href="/assets/js/66.668b4af5.js"><link rel="prefetch" href="/assets/js/67.7079acb3.js"><link rel="prefetch" href="/assets/js/68.03b5062b.js"><link rel="prefetch" href="/assets/js/69.273e5929.js"><link rel="prefetch" href="/assets/js/70.1a8460ce.js"><link rel="prefetch" href="/assets/js/71.4a0d7abc.js"><link rel="prefetch" href="/assets/js/72.7584417f.js"><link rel="prefetch" href="/assets/js/73.9a5bece9.js"><link rel="prefetch" href="/assets/js/74.e11d16de.js"><link rel="prefetch" href="/assets/js/75.f097f5fa.js"><link rel="prefetch" href="/assets/js/76.1ec34ec1.js"><link rel="prefetch" href="/assets/js/77.a00c9a4a.js"><link rel="prefetch" href="/assets/js/78.34c3c50f.js"><link rel="prefetch" href="/assets/js/79.f0f9194f.js"><link rel="prefetch" href="/assets/js/8.68085dc8.js"><link rel="prefetch" href="/assets/js/80.28944f22.js"><link rel="prefetch" href="/assets/js/81.0b004db8.js"><link rel="prefetch" href="/assets/js/82.2af9ce02.js"><link rel="prefetch" href="/assets/js/83.fea391f5.js"><link rel="prefetch" href="/assets/js/84.071bb09b.js"><link rel="prefetch" href="/assets/js/85.2b0b5bb9.js"><link rel="prefetch" href="/assets/js/86.34a9033b.js"><link rel="prefetch" href="/assets/js/87.bf346d99.js"><link rel="prefetch" href="/assets/js/88.ddc373b6.js"><link rel="prefetch" href="/assets/js/89.a3ea4c86.js"><link rel="prefetch" href="/assets/js/9.566c3b9f.js"><link rel="prefetch" href="/assets/js/90.483abaa6.js"><link rel="prefetch" href="/assets/js/91.3a6f08b1.js"><link rel="prefetch" href="/assets/js/92.54f40aa3.js"><link rel="prefetch" href="/assets/js/93.49ea68a4.js"><link rel="prefetch" href="/assets/js/94.4213815e.js"><link rel="prefetch" href="/assets/js/95.23b38eb1.js"><link rel="prefetch" href="/assets/js/96.6f4a7e3b.js"><link rel="prefetch" href="/assets/js/97.11bad6e2.js"><link rel="prefetch" href="/assets/js/98.8ff3656d.js"><link rel="prefetch" href="/assets/js/99.6a0a1f09.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f968600.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><!----> <span class="title" style="display:;">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8e9dc3400/" class="nav-link">4.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3410/" class="nav-link">4.1.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3500/" class="nav-link">5.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3p510/" class="nav-link">5.1.0-SNAPSHOT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术分类" class="dropdown-title"><!----> <span class="title" style="display:;">技术分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/note/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/note/deploy/" class="nav-link">Deploy</a></li><li class="dropdown-item"><!----> <a href="/note/application/" class="nav-link">Application</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div> <a href="https://github.com/ok1996" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/20230310/logo.3mn8xlqm9oy0.webp"> <div class="blogger-info"><h3>Xiao ku</h3> <span>板砖师傅</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><!----> <span class="title" style="display:;">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/8e9dc3400/" class="nav-link">4.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3410/" class="nav-link">4.1.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3500/" class="nav-link">5.0.0</a></li><li class="dropdown-item"><!----> <a href="/pages/8e9dc3p510/" class="nav-link">5.1.0-SNAPSHOT</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术分类" class="dropdown-title"><!----> <span class="title" style="display:;">技术分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/java/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/note/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/note/deploy/" class="nav-link">Deploy</a></li><li class="dropdown-item"><!----> <a href="/note/application/" class="nav-link">Application</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友情链接</a></div> <a href="https://github.com/ok1996" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/cc9343/" class="sidebar-link">Springboot集成redis</a></li><li><a href="/pages/79082f/" class="sidebar-link">Springboot集成mongodb</a></li><li><a href="/pages/b7c561/" class="sidebar-link">Springboot集成FastDFS</a></li><li><a href="/pages/054331/" class="sidebar-link">Springboot集成WebSocket</a></li><li><a href="/pages/957251/" aria-current="page" class="active sidebar-link">Springboot集成kafka</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/957251/#工程接入" class="sidebar-link">工程接入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/957251/#pom文件" class="sidebar-link">pom文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#yml文件" class="sidebar-link">yml文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#java文件" class="sidebar-link">JAVA文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#kafka消费者配置文件" class="sidebar-link">kafka消费者配置文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#kafka监听消费入口" class="sidebar-link">kafka监听消费入口</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/957251/#集成kafka权限" class="sidebar-link">集成KAFKA权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/957251/#在kafka消费者配置文件增加配置" class="sidebar-link">在kafka消费者配置文件增加配置</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#在resources下增加文件kafka-client-jaas-conf" class="sidebar-link">在resources下增加文件kafkaclientjaas.conf</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#启动类增加setproperty" class="sidebar-link">启动类增加setProperty</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/957251/#常用代码" class="sidebar-link">常用代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/957251/#发送实体类" class="sidebar-link">发送实体类</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#消费实体类" class="sidebar-link">消费实体类</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#监听topic使用配置文件常量" class="sidebar-link">监听topic使用配置文件常量</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#yml配置文件" class="sidebar-link">yml配置文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#java代码" class="sidebar-link">JAVA代码</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/957251/#部署kafka" class="sidebar-link">部署KAFKA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/957251/#docker-单机" class="sidebar-link">Docker-单机</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#宿主机-单机" class="sidebar-link">宿主机-单机</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#上传压缩包并解压" class="sidebar-link">上传压缩包并解压</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#修改配置并启动" class="sidebar-link">修改配置并启动</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#创建topic" class="sidebar-link">创建topic</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#配置sasl" class="sidebar-link">配置SASL</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#服务端配置" class="sidebar-link">服务端配置</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#修改server-properties" class="sidebar-link">修改server.properties</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#创建账号" class="sidebar-link">创建账号</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#修改kafka-run-class-sh" class="sidebar-link">修改kafka-run-class.sh</a></li><li class="sidebar-sub-header level4"><a href="/pages/957251/#客户端配置账号" class="sidebar-link">客户端配置账号</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#新建文件" class="sidebar-link">新建文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#修改客户端脚本" class="sidebar-link">修改客户端脚本</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#增加用户配置" class="sidebar-link">增加用户配置</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#重启" class="sidebar-link">重启</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#设置用户权限" class="sidebar-link">设置用户权限</a></li><li class="sidebar-sub-header level5"><a href="/pages/957251/#测试" class="sidebar-link">测试</a></li><li class="sidebar-sub-header level3"><a href="/pages/957251/#清除topic下数据" class="sidebar-link">清除Topic下数据</a></li></ul></li></ul></li><li><a href="/pages/25bc68/" class="sidebar-link">Springboot集成Flyway</a></li><li><a href="/pages/95e55e/" class="sidebar-link">Springboot集成ScheduleTask</a></li><li><a href="/pages/308d39/" class="sidebar-link">Validation数据校验规范使用</a></li><li><a href="/pages/84b073/" class="sidebar-link">常用代码</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/note/java/#Java" data-v-06970110>Java</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/ok1996" target="_blank" title="作者" class="beLink" data-v-06970110>xiaoku</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2023-03-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Springboot集成kafka<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="工程接入"><a href="#工程接入" class="header-anchor">#</a> 工程接入</h2> <p>kafka批量消费</p> <h3 id="pom文件"><a href="#pom文件" class="header-anchor">#</a> pom文件</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
            &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
        &lt;/dependency&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="yml文件"><a href="#yml文件" class="header-anchor">#</a> yml文件</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>server:
  servlet:
    context-path: /imdemosc
  port: 8610
spring: 
  application:
    name: imdemosc
  kafka:
    bootstrap-servers: 192.168.213.215:9092,192.168.213.215:9091,192.168.213.215:9093
    consumer:
      enable-auto-commit: true
      group-id: dsaim105
      # 批量一次最大拉取数据量
      max-poll-records: 100
      auto-commit-interval: 100
      auto-offset-reset: latest
      bootstrap-servers: 192.168.213.215:9092,192.168.213.215:9091,192.168.213.215:9093
    producer:
      # 重试次数
      retries: 3
      # 批量发送的消息数量
      batch-size: 100
      # 32MB的批处理缓冲区
      buffer-memory: 33554432
      bootstrap-servers: 192.168.213.215:9092,192.168.213.215:9091,192.168.213.215:9093
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="java文件"><a href="#java文件" class="header-anchor">#</a> JAVA文件</h3> <h4 id="kafka消费者配置文件"><a href="#kafka消费者配置文件" class="header-anchor">#</a> kafka消费者配置文件</h4> <p>KafkaConsumerConfig</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package ok96.cn;

import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.common.serialization.StringDeserializer;
import org.apache.kafka.common.serialization.StringSerializer;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.annotation.EnableKafka;
import org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory;
import org.springframework.kafka.config.KafkaListenerContainerFactory;
import org.springframework.kafka.core.DefaultKafkaConsumerFactory;
import org.springframework.kafka.core.DefaultKafkaProducerFactory;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.kafka.core.ProducerFactory;
import org.springframework.kafka.listener.ConcurrentMessageListenerContainer;

import java.util.HashMap;
import java.util.Map;
@Configuration
@EnableKafka
public class KafkaConsumerConfig {
    @Value(&quot;${spring.kafka.consumer.bootstrap-servers}&quot;)
    private String consumerBootstrapServers;

    @Value(&quot;${spring.kafka.producer.bootstrap-servers}&quot;)
    private String producerBootstrapServers;

    @Value(&quot;${spring.kafka.consumer.enable-auto-commit}&quot;)
    private Boolean autoCommit;

    @Value(&quot;${spring.kafka.consumer.auto-commit-interval}&quot;)
    private Integer autoCommitInterval;

    @Value(&quot;${spring.kafka.consumer.group-id}&quot;)
    private String groupId;

    @Value(&quot;${spring.kafka.consumer.max-poll-records}&quot;)
    private Integer maxPollRecords;

    @Value(&quot;${spring.kafka.consumer.auto-offset-reset}&quot;)
    private String autoOffsetReset;

    @Value(&quot;${spring.kafka.producer.retries}&quot;)
    private Integer retries;

    @Value(&quot;${spring.kafka.producer.batch-size}&quot;)
    private Integer batchSize;

    @Value(&quot;${spring.kafka.producer.buffer-memory}&quot;)
    private Integer bufferMemory;

    /**
     *  生产者配置信息
     */
    @Bean
    public Map&lt;String, Object&gt; producerConfigs() {
        Map&lt;String, Object&gt; props = new HashMap&lt;String, Object&gt;();
        props.put(ProducerConfig.ACKS_CONFIG, &quot;0&quot;);
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, producerBootstrapServers);
        props.put(ProducerConfig.RETRIES_CONFIG, retries);
        props.put(ProducerConfig.BATCH_SIZE_CONFIG, batchSize);
        props.put(ProducerConfig.LINGER_MS_CONFIG, 1);
        props.put(ProducerConfig.BUFFER_MEMORY_CONFIG, bufferMemory);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
        return props;
    }

    /**
     *  生产者工厂
     */
    @Bean
    public ProducerFactory&lt;String, String&gt; producerFactory() {
        return new DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());
    }

    /**
     *  生产者模板
     */
    @Bean
    public KafkaTemplate&lt;String, String&gt; kafkaTemplate() {
        return new KafkaTemplate&lt;&gt;(producerFactory());
    }

    /**
     *  消费者配置信息
     */
    @Bean
    public Map&lt;String, Object&gt; consumerConfigs() {
        Map&lt;String, Object&gt; props = new HashMap&lt;String, Object&gt;();
        props.put(ConsumerConfig.GROUP_ID_CONFIG, groupId);
        props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, autoOffsetReset);
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, consumerBootstrapServers);
        props.put(ConsumerConfig.MAX_POLL_RECORDS_CONFIG, maxPollRecords);
        props.put(ConsumerConfig.SESSION_TIMEOUT_MS_CONFIG, 120000);
        props.put(ConsumerConfig.REQUEST_TIMEOUT_MS_CONFIG, 180000);
        props.put(ConsumerConfig.HEARTBEAT_INTERVAL_MS_CONFIG, 500);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
        return props;
    }

    /**
     *  消费者批量工程
     */
    @Bean
    KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;String, String&gt;&gt; batchFactory() {
        ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;();
        factory.setConsumerFactory(new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs()));
        factory.setConcurrency(1);
        //设置为批量消费，每个批次数量在Kafka配置参数中设置ConsumerConfig.MAX_POLL_RECORDS_CONFIG
        factory.setBatchListener(true);
        factory.getContainerProperties().setPollTimeout(1000);
        
        return factory;
    }

//    @Bean
//    public KafkaConsumerListener listener(){
//        return new KafkaConsumerListener();
//    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br></div></div><h4 id="kafka监听消费入口"><a href="#kafka监听消费入口" class="header-anchor">#</a> kafka监听消费入口</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>package ok96.cn;

import static java.util.concurrent.Executors.newCachedThreadPool;

import java.util.List;
import java.util.concurrent.ExecutorService;

import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;




@Component
public class KafkaBatchListener {

    @KafkaListener(topics = &quot;imtest6&quot;, containerFactory = &quot;batchFactory&quot;)
    public void listenPartition1(List&lt;ConsumerRecord&lt;?, ?&gt;&gt; records) {
        System.out.println(&quot;我进来啦&quot;);
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="集成kafka权限"><a href="#集成kafka权限" class="header-anchor">#</a> 集成KAFKA权限</h2> <p>SASL_PLAINTEXT</p> <h3 id="在kafka消费者配置文件增加配置"><a href="#在kafka消费者配置文件增加配置" class="header-anchor">#</a> 在kafka消费者配置文件增加配置</h3> <p>在producerConfigs方法和consumerConfigs方法中增加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>props.put(&quot;security.protocol&quot;,&quot;SASL_PLAINTEXT&quot;);
props.put(&quot;sasl.mechanism&quot;,&quot;PLAIN&quot;);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="在resources下增加文件kafka-client-jaas-conf"><a href="#在resources下增加文件kafka-client-jaas-conf" class="header-anchor">#</a> 在resources下增加文件kafka_client_jaas.conf</h3> <p>文件内容username和password为kafka中设置的权限账号密码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KafkaClient {
  org.apache.kafka.common.security.plain.PlainLoginModule required
  username=&quot;ok96&quot;
  password=&quot;ok96-password&quot;;
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="启动类增加setproperty"><a href="#启动类增加setproperty" class="header-anchor">#</a> 启动类增加setProperty</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>@SpringBootApplication
public class SpringbootApp {
    public static void main(String[] args) {
        String dirname = &quot;classpath:kafka_client_jaas.conf&quot;;
        System.setProperty(&quot;java.security.auth.login.config&quot;, dirname);
        SpringApplication.run(SpringbootApp.class, args);
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="常用代码"><a href="#常用代码" class="header-anchor">#</a> 常用代码</h2> <h3 id="发送实体类"><a href="#发送实体类" class="header-anchor">#</a> 发送实体类</h3> <p>也就是先将XXXX实体类转换成String</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ObjectMapper mapper2 = new ObjectMapper();
kafkaTemplate.send(topic, mapper2.writeValueAsString(XXXXX));
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="消费实体类"><a href="#消费实体类" class="header-anchor">#</a> 消费实体类</h3> <p>也就是将String转换成XXXX实体类,可以在getTypeReference方法修改为静态方法，增加static<br>
修改KafkaBatchListener</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package cn.ok96;

import java.util.List;
import java.util.concurrent.ExecutorService;
import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

@Component
public class KafkaBatchListener {

    public TypeReference&lt;?&gt; getTypeReferenceTemp() {
        return new TypeReference&lt;XXXX&gt;() {
        };
    }
    
    @KafkaListener(topics = &quot;imtest6&quot;, containerFactory = &quot;batchFactory&quot;)
    public void listenPartition1(List&lt;ConsumerRecord&lt;String,String&gt;&gt; records) {
        for (ConsumerRecord&lt;String, String&gt; record : records) {
            Optional&lt;String&gt; kafkaMessage = Optional.ofNullable(record.value());
            if (kafkaMessage.isPresent()) {
                //消息接收正常
                ObjectMapper mapper2 = new ObjectMapper();
                XXXX xxxx = (XXXX) mapper2.readValue(record.value(), getTypeReferenceTemp());
            }
        }
        
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="监听topic使用配置文件常量"><a href="#监听topic使用配置文件常量" class="header-anchor">#</a> 监听topic使用配置文件常量</h3> <h4 id="yml配置文件"><a href="#yml配置文件" class="header-anchor">#</a> yml配置文件</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>kafkaSelf:
  topic: test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="java代码"><a href="#java代码" class="header-anchor">#</a> JAVA代码</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>@KafkaListener(topics = &quot;#{'${kafkaSelf.topic}'}&quot;, containerFactory = &quot;batchFactory&quot;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="部署kafka"><a href="#部署kafka" class="header-anchor">#</a> 部署KAFKA</h2> <p>服务器IP：192.168.213.200</p> <h3 id="docker-单机"><a href="#docker-单机" class="header-anchor">#</a> Docker-单机</h3> <p>docker-compose.yml，连接地址192.168.213.200:19092</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: '3'
services:
  kafka-zookeeper:
    image: openzipkin/zipkin-kafka:2.11.12
    restart: always
    container_name: kafka-zookeeper
    ports:
      - 2181:2181
      - 9092:9092
      - 19092:19092
    environment:
      - KAFKA_ADVERTISED_HOST_NAME=192.168.213.200
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>命令行</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d --restart=always --name kafka-zookeeper -p 2181:2181 -p 9092:9092 -p 19092:19092  --env KAFKA_ADVERTISED_HOST_NAME=192.168.213.200  openzipkin/zipkin-kafka:2.11.12
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>部署成功测试</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1.开启两个终端进入kafka
docker exec -it kafka-zookeeper /bin/sh
2.分别在终端容器内部执行
终端1
unset JMX_PORT;bin/kafka-console-producer.sh --broker-list 192.168.213.200:19092 --topic test9999
终端2
unset JMX_PORT;bin/kafka-console-consumer.sh --bootstrap-server 192.168.213.200:19092 --topic test9999 --from-beginning
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="宿主机-单机"><a href="#宿主机-单机" class="header-anchor">#</a> 宿主机-单机</h3> <p>服务器ip：192.168.213.203<br>
连接地址：192.168.213.203:9092</p> <h4 id="上传压缩包并解压"><a href="#上传压缩包并解压" class="header-anchor">#</a> 上传压缩包并解压</h4> <p>上传kafka_2.12-2.3.0.tgz到/data/目录下<br>
解压</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zvxf kafka_2.12-2.3.0.tgz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="修改配置并启动"><a href="#修改配置并启动" class="header-anchor">#</a> 修改配置并启动</h4> <p>修改server.properties</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/server.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加以下内容，保存并退出</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>listeners=PLAINTEXT://192.168.213.203:9092
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/note-9455.fc79c03f.png" alt="note"></p> <p>启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /data/kafka_2.12-2.3.0
bin/zookeeper-server-start.sh -daemon config/zookeeper.properties
bin/kafka-server-start.sh -daemon  config/server.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>查看日志</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tail -f /data/kafka_2.12-2.3.0/logs/zookeeper.out
tail -f /data/kafka_2.12-2.3.0/logs/kafkaServer.out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="创建topic"><a href="#创建topic" class="header-anchor">#</a> 创建topic</h4> <p>创建topic：tpc.test001</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/data/kafka_2.12-2.3.0/bin/kafka-topics.sh --create --zookeeper 192.168.213.203:2181 --replication-factor 1 --partitions 1 --topic tpc.test001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="配置sasl"><a href="#配置sasl" class="header-anchor">#</a> 配置SASL</h3> <h4 id="服务端配置"><a href="#服务端配置" class="header-anchor">#</a> 服务端配置</h4> <h5 id="修改server-properties"><a href="#修改server-properties" class="header-anchor">#</a> 修改server.properties</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/server.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>修改/增加以下内容,将原来写的listeners用#注释</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>listeners=SASL_PLAINTEXT://192.168.213.203:9092
security.inter.broker.protocol=SASL_PLAINTEXT
sasl.mechanism.inter.broker.protocol=PLAIN
sasl.enabled.mechanisms=PLAIN
authorizer.class.name=kafka.security.auth.SimpleAclAuthorizer
allow.everyone.if.no.acl.found=true
super.users=User:admin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/assets/img/note-4093.2560193c.png" alt="note"></p> <h5 id="创建账号"><a href="#创建账号" class="header-anchor">#</a> 创建账号</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/kafka_server_jaas.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加以下内容,保存并退出</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KafkaServer {
org.apache.kafka.common.security.plain.PlainLoginModule required
username=&quot;admin&quot;
password=&quot;admin-pwd&quot;
user_admin=&quot;admin-pwd&quot;
user_wuxiaoku=&quot;xiaoku-lzx22247a&quot;;
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>管理员账号：admin 密码 admin-pwd</p> <p>普通用户账号：wuxiaoku 密码 xiaoku-lzx22247a
<img src="/assets/img/note-53388.d33d148b.png" alt="note"></p> <h5 id="修改kafka-run-class-sh"><a href="#修改kafka-run-class-sh" class="header-anchor">#</a> 修改kafka-run-class.sh</h5> <p>添加java.security.auth.login.config环境变量</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/bin/kafka-run-class.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KAFKA_SASL_OPTS='-Djava.security.auth.login.config=/data/kafka_2.12-2.3.0/config/kafka_server_jaas.conf'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$KAFKA_SASL_OPTS
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/note-31824.036b75ca.png" alt="note"></p> <h4 id="客户端配置账号"><a href="#客户端配置账号" class="header-anchor">#</a> 客户端配置账号</h4> <h5 id="新建文件"><a href="#新建文件" class="header-anchor">#</a> 新建文件</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/kafka_client_jaas.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>新增以下内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KafkaClient {
  org.apache.kafka.common.security.plain.PlainLoginModule required
  username=&quot;wuxiaoku&quot;
  password=&quot;xiaoku-lzx22247a&quot;;
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="/assets/img/note-67784.053375a0.png" alt="note"></p> <h5 id="修改客户端脚本"><a href="#修改客户端脚本" class="header-anchor">#</a> 修改客户端脚本</h5> <p>消费者：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/consumer.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后一行加上如下配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>security.protocol=SASL_PLAINTEXT
sasl.mechanism=PLAIN
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/note-87251.cd4ce102.png" alt="note">
生产者：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/config/producer.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后一行加上如下配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>security.protocol=SASL_PLAINTEXT
sasl.mechanism=PLAIN
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/note-83190.ab10e7b5.png" alt="note"></p> <h5 id="增加用户配置"><a href="#增加用户配置" class="header-anchor">#</a> 增加用户配置</h5> <p>消费者：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/bin/kafka-console-consumer.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加以下内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export KAFKA_OPTS=&quot;-Djava.security.auth.login.config=/data/kafka_2.12-2.3.0/config/kafka_client_jaas.conf&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/note-95733.b3617902.png" alt="note"></p> <p>生产者：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /data/kafka_2.12-2.3.0/bin/kafka-console-producer.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>增加以下内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export KAFKA_OPTS=&quot;-Djava.security.auth.login.config=/data/kafka_2.12-2.3.0/config/kafka_client_jaas.conf&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/note-65433.cbaf7be8.png" alt="note"></p> <h5 id="重启"><a href="#重启" class="header-anchor">#</a> 重启</h5> <p>关闭命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /data/kafka_2.12-2.3.0
bin/kafka-server-stop.sh config/server.properties
bin/zookeeper-server-stop.sh config/zookeeper.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>启动：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/zookeeper-server-start.sh -daemon config/zookeeper.properties
bin/kafka-server-start.sh -daemon  config/server.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="设置用户权限"><a href="#设置用户权限" class="header-anchor">#</a> 设置用户权限</h5> <p>可百度 kfaka ACL</p> <p>赋权：add 移除：remove 读：Read 写：Write</p> <p>设置白名单：--allow-host 192.168.213.200</p> <p>设置组权限：--group 设置topic权限--topic</p> <p>对wuxiaoku用户的组test-consumer-group设置所有权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --authorizer kafka.security.auth.SimpleAclAuthorizer --authorizer-properties zookeeper.connect=192.168.213.203:2181 --add --allow-principal User:wuxiaoku --operation All --group test-consumer-group
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对wuxiaoku用户赋权topic读权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.213.203:2181 --add  --allow-principal User:wuxiaoku  --allow-host '*' --operation Read --topic tpc.test001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对wuxiaoku用户移除topic读权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.213.203:2181 --remove  --allow-principal User:wuxiaoku  --allow-host '*' --operation Read --topic tpc.test001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对wuxiaoku用户赋权topic写权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.213.203:2181 --add  --allow-principal User:wuxiaoku  --allow-host '*' --operation Write --topic tpc.test001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对wuxiaoku用户移除topic写权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.213.203:2181 --remove  --allow-principal User:wuxiaoku  --allow-host '*' --operation Write --topic tpc.test001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看权限</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bin/kafka-acls.sh --list --authorizer-properties zookeeper.connect=192.168.213.203:2181
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="测试"><a href="#测试" class="header-anchor">#</a> 测试</h5> <p>开启两个终端</p> <p>1终端消费者执行命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/data/kafka_2.12-2.3.0/bin/kafka-console-consumer.sh --bootstrap-server 192.168.213.203:9092 --topic  tpc.test001  --from-beginning --consumer.config /data/kafka_2.12-2.3.0/config/consumer.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>2终端生产者执行命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/data/kafka_2.12-2.3.0/bin/kafka-console-producer.sh --broker-list 192.168.213.203:9092 --topic tpc.test001  --producer.config /data/kafka_2.12-2.3.0/config/producer.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在生产者终端发送随机字符串，在消费者终端能接收数据即正常
<img src="/assets/img/note-98726.73b17ebd.png" alt="note"></p> <h3 id="清除topic下数据"><a href="#清除topic下数据" class="header-anchor">#</a> 清除Topic下数据</h3> <p>例topic：cardata</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1.修改保留时间为10秒
bin/kafka-configs.sh --zookeeper 127.0.0.1:2181 --entity-type topics --entity-name cardata --alter --add-config retention.ms=10000
2.查看topic策略
bin/kafka-configs.sh --zookeeper 127.0.0.1:2181 --describe --entity-type topics --entity-name cardata
3.等待数据清理后，删除策略
bin/kafka-configs.sh --zookeeper 127.0.0.1:2181 --entity-type topics --entity-name cardata --alter --delete-config retention.ms
4.再次查看策略
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/17, 09:00:35</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/054331/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Springboot集成WebSocket</div></a> <a href="/pages/25bc68/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Springboot集成Flyway</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/054331/" class="prev">Springboot集成WebSocket</a></span> <span class="next"><a href="/pages/25bc68/">Springboot集成Flyway</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer">
     Copyright © 2019-2023
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ac31a06.js" defer></script><script src="/assets/js/4.1fc6d7d0.js" defer></script><script src="/assets/js/10.f1d01818.js" defer></script><script src="/assets/js/7.b3c10a4a.js" defer></script>
  </body>
</html>
