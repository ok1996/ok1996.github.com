(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{624:function(s,a,e){"use strict";e.r(a);var r=e(7),n=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"二进制文件安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二进制文件安装"}},[s._v("#")]),s._v(" 二进制文件安装")]),s._v(" "),a("p",[s._v("简便的离线部署，一键脚本都是自行研究的，后续若有完善再更新")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("链接：https://pan.baidu.com/s/1-Wfe6CPrif1LhbgQvXrNWw \n提取码：zhcg\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("文件上传到服务器后赋权"),a("br"),s._v("\nchmod -R 777 docker-init.sh"),a("br"),s._v("\n然后执行脚本就完成docker和docker-compose的离线部署了")]),s._v(" "),a("p",[s._v("官方参考文档：https://docs.docker.com/engine/install/binaries/")]),s._v(" "),a("h2",{attrs:{id:"docker修改镜像和容器的存放路径"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker修改镜像和容器的存放路径"}},[s._v("#")]),s._v(" docker修改镜像和容器的存放路径")]),s._v(" "),a("p",[s._v("前提，将镜像先删除")]),s._v(" "),a("h3",{attrs:{id:"方式1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式1"}},[s._v("#")]),s._v(" 方式1")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1、停止docker 服务\nsystemctl stop docker\n2、备份数据到新的存放路径\ncp -r /var/lib/docker/* /data/docker\n3、备份 /var/lib/docker 路径\nmv /var/lib/docker  /var/lib/dockerbak\n4、创建软连接\nln -s /data/docker /var/lib/docker\n5、启动docker\nsystemctl start docker\n如果docker完整，并可用，可删除原来的备份文件\n此方法，启动Docker时发现存储目录依旧是/var/lib/docker，但是实际上是存储在数据盘的，你可以在数据盘上看到容量变化\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@huasan ~]# systemctl stop docker\n[root@huasan ~]# mkdir -p /data/docker\n[root@huasan ~]# cp -r /var/lib/docker/* /data/docker\n[root@huasan ~]# mv /var/lib/docker /var/lib/dockerbak\n[root@huasan ~]# ln -s /data/docker /var/lib/docker\n[root@huasan ~]# systemctl start docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"方式2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式2"}},[s._v("#")]),s._v(" 方式2")]),s._v(" "),a("p",[s._v("修改默认目录")]),s._v(" "),a("p",[s._v("vi /etc/docker/daemon.json")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n  "data-root": "/data/docker"\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("重启docker")]),s._v(" "),a("p",[s._v("systemctl restart docker\n检查")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /data/docker\nls\n或者\ndocker info\n查看\nDocker Root Dir: /data/docker\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("恢复：")]),s._v(" "),a("p",[s._v("修改daemon.json")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n  "data-root": "/var/lib/docker"\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);